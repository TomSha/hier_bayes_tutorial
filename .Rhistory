mtext(plot_norm<-function(n=100,mu=100,sig=1.5,S=1.5){
dat<-rnorm(n,mu,sig)
hist(dat,ann=F,main="")
mtext(text="Fluorescence level (AU)",side=1,line=1.5,cex=S)
}
plot_norm<-function(n=100,mu=100,sig=1.5,S=1.5){
dat<-rnorm(n,mu,sig)
hist(dat,ann=F,main="")
mtext(text="Fluorescence level (AU)",side=1,line=1.5,cex=S)
}
plot_norm()
plot_norm<-function(n=100,mu=100,sig=1.5,S=1.5){
dat<-rnorm(n,mu,sig)
hist(dat,ann=F,main="")
mtext(text="Fluorescence level (AU)",side=1,line=2,cex=S)
}
plot_norm()
plot_norm<-function(n=100,mu=100,sig=1.5,S=1.5,L=2.5){
dat<-rnorm(n,mu,sig)
hist(dat,ann=F,main="")
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S)
}
plot_norm()
plot_norm<-function(n=100,mu=100,sig=1.5,S=1.5,L=2.5){
dat<-rnorm(n,mu,sig)
hist(dat,ann=F,main="")
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S)
mtext(text="Counts",side=2,line=1.5,cex=S)
}
plot_norm()
plot_norm<-function(n=100,mu=100,sig=1.5,S=1.5,L=2.5){
dat<-rnorm(n,mu,sig)
hist(dat,ann=F,main="")
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S)
mtext(text="Counts",side=2,line=L,cex=S)
}
plot_norm()
plot_norm<-function(n=100,mu=100,sig=1.5,S=1.5,L=2.5){
dat<-rnorm(n,mu,sig)
hist(dat,ann=F,main="",font.axis=2)
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S)
mtext(text="Counts",side=2,line=L,cex=S)
}
plot_norm()
plot_norm<-function(n=100,mu=100,sig=1.5,S=1.5,L=2.5){
dat<-rnorm(n,mu,sig)
hist(dat,ann=F,main="",font.axis=2)
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
}
plot_norm()
dat<-rnorm(n,mu,sig)
n=100
mu=100
sig=1.5
dat<-rnorm(n,mu,sig)
dat
library(MASS)
fitdistr(dat)
dat
library(fitdistRplus)
library(fitdistrplus)
fitdist(dat,distr="norm",method="mle")
params<-fitdist(dat,distr="norm",method="mle")
plot(params)
params
params[[1]]
plot(params[[1]])
params[[1]]
plot(params)
str(params)
dat
lines(params)
density(dat)
str(params)
xfit<-seq(min(dat)-1,max(dat)+1,length=1000)
xfit<-seq(min(dat)-1,max(dat)+1,length=1000)
yfit<-dnorm(xfit,params$estimate[1],params$estimate[2])
yfit
xfit
h<-hist(dat,ann=F,main="",font.axis=2)
h
h$mids
diff(h$mids)
diff(h$mids[1:2])
diff(h$mids[1:2])*length(dat)
yfit*diff(h$mids[1:2])*length(dat)
yfit
lines(xfit,yfit,col="blue",lwd=2)
yfit*diff(h$mids[1:2])*length(dat)yfit<-yfit*diff(h$mids[1:2]*length(dat))
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=2)
plot_norm<-function(n=100,mu=100,sig=1.5,S=1.5,L=2.5){
plot_norm<-function(n=100,mu=100,sig=1.5,S=1.5,L=2.5){
dat<-rnorm(n,mu,sig)
h<-hist(dat,ann=F,main="",font.axis=2,col="red")
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
params<-fitdist(x=dat,method="mle",dist="norm")
xfit<-seq(min(dat)-1,max(dat)+1,length=1000)
yfit<-dnorm(xfit,params$estimate[1],params$estimate[2])
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=2)
}
}
plot_norm()
plot_norm()
plot_norm<-function(plot_dens=T,n=100,mu=100,sig=1.5,S=1.5,L=2.5){
dat<-rnorm(n,mu,sig)
h<-hist(dat,ann=F,main="",font.axis=2,col="red")
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
params<-fitdist(x=dat,method="mle",dist="norm")
xfit<-seq(min(dat)-1,max(dat)+1,length=1000)
yfit<-dnorm(xfit,params$estimate[1],params$estimate[2])
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=2)
}
}
plot_norm()
dat<-rnorm(n,mu,sig)
h<-hist(dat,ann=F,main="",font.axis=2,col="red")
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
params<-fitdist(x=dat,method="mle",dist="norm")
dat
plot_norm<-function(plot_dens=T,n=100,mu=100,sig=1.5,S=1.5,L=2.5){
dat<-rnorm(n,mu,sig)
h<-hist(dat,ann=F,main="",font.axis=2,col="red")
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
params<-fitdist(data=dat,method="mle",dist="norm")
xfit<-seq(min(dat)-1,max(dat)+1,length=1000)
yfit<-dnorm(xfit,params$estimate[1],params$estimate[2])
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=2)
}
}
plot_norm()
plot_norm(F)
set.seed(543)plot_norm<-function(plot_dens=T,n=100,mu=100,sig=1.5,S=1.5,L=2.5){
dat<-rnorm(n,mu,sig)
h<-hist(dat,ann=F,main="",font.axis=2,col="red")
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
params<-fitdist(data=dat,method="mle",dist="norm")
xfit<-seq(min(dat)-1,max(dat)+1,length=1000)
yfit<-dnorm(xfit,params$estimate[1],params$estimate[2])
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=2)
}
}
plot_norm<-function(plot_dens=T,n=100,mu=100,sig=1.5,S=1.5,L=2.5){
set.seed(543)
dat<-rnorm(n,mu,sig)
h<-hist(dat,ann=F,main="",font.axis=2,col="red")
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
params<-fitdist(data=dat,method="mle",dist="norm")
xfit<-seq(min(dat)-1,max(dat)+1,length=1000)
yfit<-dnorm(xfit,params$estimate[1],params$estimate[2])
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=2)
}
}
plot_norm()
plot_norm()
plot_norm<-function(plot_dens=T,n=100,mu=100,sig=1.5,S=1.5,L=2.5){
set.seed(540)
dat<-rnorm(n,mu,sig)
h<-hist(dat,ann=F,main="",font.axis=2,col="red")
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
params<-fitdist(data=dat,method="mle",dist="norm")
xfit<-seq(min(dat)-1,max(dat)+1,length=1000)
yfit<-dnorm(xfit,params$estimate[1],params$estimate[2])
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=2)
}
}
plot_norm()
plot_norm<-function(plot_dens=T,n=100,mu=100,sig=1.5,S=1.5,L=2.5){
set.seed(540)
dat<-rnorm(n,mu,sig)
h<-hist(dat,ann=F,main="",font.axis=2,col="red",ylim=c(0,30))
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
params<-fitdist(data=dat,method="mle",dist="norm")
xfit<-seq(min(dat)-1,max(dat)+1,length=1000)
yfit<-dnorm(xfit,params$estimate[1],params$estimate[2])
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=2)
}
}
plot_norm()
plot_norm<-function(plot_dens=T,n=100,mu=100,sig=1.5,S=1.5,L=2.5){
set.seed(540)
dat<-rnorm(n,mu,sig)
h<-hist(dat,ann=F,main="",font.axis=2,col="red",ylim=c(0,30),breaks=50)
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
params<-fitdist(data=dat,method="mle",dist="norm")
xfit<-seq(min(dat)-1,max(dat)+1,length=1000)
yfit<-dnorm(xfit,params$estimate[1],params$estimate[2])
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=2)
}
}
plot_norm()
plot_norm<-function(plot_dens=T,n=1000,mu=100,sig=1.5,S=1.5,L=2.5){
set.seed(540)
dat<-rnorm(n,mu,sig)
h<-hist(dat,ann=F,main="",font.axis=2,col="red",ylim=c(0,30),breaks=50)
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
params<-fitdist(data=dat,method="mle",dist="norm")
xfit<-seq(min(dat)-1,max(dat)+1,length=1000)
yfit<-dnorm(xfit,params$estimate[1],params$estimate[2])
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=2)
}
}
plot_norm()
plot_norm<-function(plot_dens=T,n=500,mu=100,sig=1.5,S=1.5,L=2.5){
set.seed(540)
dat<-rnorm(n,mu,sig)
h<-hist(dat,ann=F,main="",font.axis=2,col="red",ylim=c(0,30),breaks=50)
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
params<-fitdist(data=dat,method="mle",dist="norm")
xfit<-seq(min(dat)-1,max(dat)+1,length=1000)
yfit<-dnorm(xfit,params$estimate[1],params$estimate[2])
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=2)
}
}
plot_norm()
plot_norm<-function(plot_dens=T,n=500,mu=100,sig=1.5,S=1.5,L=2.5){
set.seed(540)
dat<-rnorm(n,mu,sig)
h<-hist(dat,ann=F,main="",font.axis=2,col="red",ylim=c(0,50),breaks=50)
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
params<-fitdist(data=dat,method="mle",dist="norm")
xfit<-seq(min(dat)-1,max(dat)+1,length=1000)
yfit<-dnorm(xfit,params$estimate[1],params$estimate[2])
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=2)
}
}
plot_norm()
plot_norm<-function(plot_dens=T,n=500,mu=100,sig=1.5,S=1.5,L=2.5){
set.seed(500)
dat<-rnorm(n,mu,sig)
h<-hist(dat,ann=F,main="",font.axis=2,col="red",ylim=c(0,50),breaks=50)
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
params<-fitdist(data=dat,method="mle",dist="norm")
xfit<-seq(min(dat)-1,max(dat)+1,length=1000)
yfit<-dnorm(xfit,params$estimate[1],params$estimate[2])
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=2)
}
}
plot_norm()
plot_norm<-function(plot_dens=T,n=500,mu=100,sig=1.5,S=1.5,L=2.5){
set.seed(260390)
dat<-rnorm(n,mu,sig)
h<-hist(dat,ann=F,main="",font.axis=2,col="red",ylim=c(0,50),breaks=50)
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
params<-fitdist(data=dat,method="mle",dist="norm")
xfit<-seq(min(dat)-1,max(dat)+1,length=1000)
yfit<-dnorm(xfit,params$estimate[1],params$estimate[2])
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=2)
}
}
plot_norm()
plot_norm(F)
plot_norm<-function(plot_dens=T,n=500,mu=100,sig=1.5,S=1.5,L=2.5){
set.seed(260390)
dat<-rnorm(n,mu,sig)
h<-hist(dat,ann=F,main="",font.axis=2,col="red",ylim=c(0,50),breaks=50)
mtext(text="Fluorescence level (AU)",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
params<-fitdist(data=dat,method="mle",dist="norm")
xfit<-seq(min(dat)-1,max(dat)+1,length=1000)
yfit<-dnorm(xfit,params$estimate[1],params$estimate[2])
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=3)
}
}
plot_norm()
rbinom(n=100,size=10,prob=0.5)
plot(rbinom(n=100,size=10,prob=0.5))
hist(rbinom(n=100,size=10,prob=0.5))
hist(rbinom(n=100,size=10,prob=0.5))
hist(rbinom(n=1000,size=10,prob=0.5))
plot(rbinom(n=1000,size=10,prob=0.5))
hist(rbinom(n=1000,size=10,prob=0.5))
hist(rbinom(n=1000,size=2,prob=0.5))
hist(rbinom(n=1000,prob=0.5))
hist(rbinom(n=1000,prob=0.5,size=10))
hist(rbinom(n=1000,prob=0.5,size=1))
hist(rbinom(n=2,prob=0.5,size=1))
hist(rbinom(n=2,prob=0.5,size=2))
hist(rbinom(n=2,prob=0.5,size=3))
hist(rbinom(n=2,prob=0.5,size=10))
hist(rbinom(n=10,prob=0.5,size=10))
hist(rbinom(n=10,prob=0.5,size=100))
rbinom(n=10,prob=0.5,size=100)
plot(rbinom(n=10,prob=0.5,size=100))
rbinom(n=10,prob=0.5,size=100)
barplot(rbinom(n=10,prob=0.5,size=100))
hist(rbinom(n=10,prob=0.5,size=100))
hist(rbinom(n=100,prob=0.5,size=100))
hist(rbinom(n=100,prob=0.5,size=1000))
hist(rbinom(n=100,prob=0.5,size=1000))
hist(rbinom(n=100,prob=0.5,size=1000))
hist(rbinom(n=100,prob=0.5,size=1000))
hist(rbinom(n=100,prob=0.5,size=1000))
rbinom(n=100,prob=0.5,size=1000)
dat<-rbinom(n=100,prob=0.5,size=1000)
fitdist(data=dat,method="mle",dist="binom")
help(fitdist)
fitdist(data=dat,method="mle",distr="binom")
dat
fitdist(data=dat,method="mle",distr="binom",start=list(size=flips,prob=p))
flips=1000
fitdist(data=dat,method="mle",distr="binom",start=list(size=flips,prob=p))
p=0.5
fitdist(data=dat,method="mle",distr="binom",start=list(size=flips,prob=p))
fitdist(data=dat,method="mle",distr="binom",start=list(size=flips,prob=p))
fitdist(data=dat,method="mme",distr="binom",start=list(size=flips,prob=p))
fitdist(data=dat,method="mle",distr="binom",start=list(size=flips,prob=p))
dbinom(x=seq(from=400,to=600,length.out=1000),size=flips,prob=p)
warnings()
dbinom(x=seq(from=400,to=600,length.out=200),size=flips,prob=p)
dbinom(x=seq(from=400,to=600,length.out=201),size=flips,prob=p)
points(dbinom(x=seq(from=400,to=600,length.out=201),size=flips,prob=p))
points(dbinom(x=seq(from=400,to=600,length.out=201),size=flips,prob=p),cex=100)
[Aplot_binom<-function(plot_dens=T,trials=50,p=0.5,flips=1000,S=1.5,L=2.5){
set.seed(260390)
dat<-rbinom(n=trials,size=flips,prob=p)
h<-hist(dat,ann=F,main="",font.axis=2,col="red",ylim=c(0,50),breaks=50)
mtext(text="Number of successes",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
xfit<-seq(min(dat)-10,max(dat)+10,length=1000)
yfit<-dbinom(xfit,size=flips,prob=p)
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=3)
}
}
plot_binom<-function(plot_dens=T,trials=50,p=0.5,flips=1000,S=1.5,L=2.5){
set.seed(260390)
dat<-rbinom(n=trials,size=flips,prob=p)
h<-hist(dat,ann=F,main="",font.axis=2,col="red",ylim=c(0,50),breaks=50)
mtext(text="Number of successes",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
xfit<-seq(min(dat)-10,max(dat)+10,length=1000)
yfit<-dbinom(xfit,size=flips,prob=p)
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=3)
}
}
plot_binom()
plot_binom<-function(plot_dens=T,trials=50,p=0.5,flips=100,S=1.5,L=2.5){
set.seed(260390)
dat<-rbinom(n=trials,size=flips,prob=p)
h<-hist(dat,ann=F,main="",font.axis=2,col="red",ylim=c(0,50),breaks=50)
mtext(text="Number of successes",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
xfit<-seq(min(dat)-10,max(dat)+10,length=1000)
yfit<-dbinom(xfit,size=flips,prob=p)
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=3)
}
}
plot_binom<-function(plot_dens=T,trials=50,p=0.5,flips=100,S=1.5,L=2.5){
set.seed(260390)
dat<-rbinom(n=trials,size=flips,prob=p)
h<-hist(dat,ann=F,main="",font.axis=2,col="red",ylim=c(0,10),breaks=50)
mtext(text="Number of successes",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
xfit<-seq(min(dat)-10,max(dat)+10,length=1000)
yfit<-dbinom(xfit,size=flips,prob=p)
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=3)
}
}
plot_binom()
plot_binom<-function(plot_dens=T,trials=500,p=0.5,flips=100,S=1.5,L=2.5){
set.seed(260390)
dat<-rbinom(n=trials,size=flips,prob=p)
h<-hist(dat,ann=F,main="",font.axis=2,col="red",ylim=c(0,10),breaks=50)
mtext(text="Number of successes",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
if(plot_dens){
xfit<-seq(min(dat)-10,max(dat)+10,length=1000)
yfit<-dbinom(xfit,size=flips,prob=p)
yfit<-yfit*diff(h$mids[1:2]*length(dat))
lines(xfit,yfit,col="blue",lwd=3)
}
}
plot_binom()
plot_norm()
set.seed(260390)
dat<-rbinom(n=trials,size=flips,prob=p)
trials=500
flips=100
p=0.5
set.seed(260390)
dat<-rbinom(n=trials,size=flips,prob=p)
h<-hist(dat,ann=F,main="",font.axis=2,col="red",ylim=c(0,10),breaks=50)
mtext(text="Number of successes",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
L=2.5
S=1.5
mtext(text="Number of successes",side=1,line=L,cex=S,font=2)
mtext(text="Counts",side=2,line=L,cex=S,font=2)
h<-barplot(dat,ann=F,main="",font.axis=2,col="red",ylim=c(0,10))
h<-barplot(dat,ann=F,main="",font.axis=2,col="red")
h<-hist(dat,ann=F,main="",font.axis=2,col="red")
plot_norm()
gridsize=100
successes=25
trials=100
p_grid <- seq(from=0,to=1,length.out=grid_size)
grid_size=100
p_grid <- seq(from=0,to=1,length.out=grid_size)
likelihood <- dbinom(successes,size=trials,prob=p_grid)
plot(p_grid,posterior,type="b",xlab="probability of success",ylab="posterior probability" )
plot(p_grid,likelihood,type="b",xlab="probability of success",ylab="posterior probability" )
plot_norm()
plot_norm()
png("/media/tom/Samsung_T5/Work/Presentations/230721_hier_bayes/norm_dist.png")
plot_norm(F)
dev.off()
png("/media/tom/Samsung_T5/Work/Presentations/230721_hier_bayes/norm_dist_dens.png")
plot_norm(T)
dev.off()
quit()
